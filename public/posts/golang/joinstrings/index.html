<!DOCTYPE html>
<html lang="zh">
  <head>
    <title>Golang å¦‚ä½•é«˜æ•ˆæ‹¼æ¥å­—ç¬¦ä¸² | taojyçš„æŠ€æœ¯åšå®¢</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="åœ¨ Go è¯­è¨€ä¸­ï¼Œå­—ç¬¦ä¸²(string) æ˜¯ä¸å¯å˜çš„ï¼Œæ‹¼æ¥å­—ç¬¦ä¸²äº‹å®ä¸Šæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²å¯¹è±¡ã€‚å¦‚æœä»£ç ä¸­å­˜åœ¨å¤§é‡çš„å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå¯¹æ€§èƒ½ä¼šäº§ç”Ÿä¸¥é‡çš„å½±å“ã€‚
å‡ ç§å¸¸è§çš„æ‹¼æ¥æ–¹å¼ ğŸ”— ä½¿ç”¨ &#43; è¿›è¡Œæ‹¼æ¥ï¼› ä½¿ç”¨ fmt.Spintf() è¿›è¡Œæ‹¼æ¥; ä½¿ç”¨ strings.Builderï¼ˆå¯é¢„åˆ†é…ï¼‰ è¿›è¡Œæ‹¼æ¥ï¼ˆæ¨èï¼‰; ä½¿ç”¨ bytes.Buffer è¿›è¡Œæ‹¼æ¥; ä½¿ç”¨ []byteï¼ˆå¯é¢„åˆ†é…ï¼‰ è¿›è¡Œæ‹¼æ¥ï¼› æ€§èƒ½æ¯”è¾ƒ ğŸ”—æ¯”è¾ƒé€»è¾‘ä»£ç  ğŸ”— go test -bench=&quot;Concat$&quot; -benchmem . // æ­£åˆ™æ‰§è¡Œä»¥ Concat ç»“å°¾çš„ benchmark å‡½æ•°ï¼Œ-benchmem è¡¨ç¤ºæ˜¾ç¤ºå†…å­˜åˆ†é…ä¿¡æ¯
package main import ( &#34;bytes&#34; &#34;fmt&#34; &#34;math/rand&#34; &#34;strings&#34; &#34;testing&#34; ) const letterBytes = &#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#34; func randomString(n int) string { b := make([]byte, n) for i := range b { b[i] = letterBytes[rand.Intn(len(letterBytes))] } return string(b) } func plusConcat(n int, str string) string { s := &#34;&#34; for i := 0; i &lt; n; i&#43;&#43; { s &#43;= str } return s } func sprintfConcat(n int, str string) string { s := &#34;&#34; for i := 0; i &lt; n; i&#43;&#43; { s = fmt.">
<meta name="generator" content="Hugo 0.124.1">


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="stylesheet" href="/css/style.css">



<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />








  </head>

  <body>
    <nav class="navigation">
	
		<a href="/"> <span class="arrow">â†</span>é¦–é¡µ</a>
	
	<a href="/posts">å½’æ¡£</a>
	<a href="/tags">æ ‡ç­¾</a>
	<a href="/about">å…³äº</a>

	

	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">Golang å¦‚ä½•é«˜æ•ˆæ‹¼æ¥å­—ç¬¦ä¸²</h1>

    <div class="tip">
        <time datetime="2022-03-27 21:30:20 &#43;0800 CST">2022å¹´03æœˆ27æ—¥</time>
        <span class="split">
          Â·
        </span>
        <span>
          531å­—
        </span>
        <span class="split">
          Â·
        </span>
        <span>
          3åˆ†é’Ÿ
        </span>
    </div>

    
    
        
  
    <aside class="toc">
      <details>
          <summary>Table of Contents
          </summary>
          <div>
              <nav id="TableOfContents">
  <ul>
    <li><a href="#å‡ ç§å¸¸è§çš„æ‹¼æ¥æ–¹å¼">å‡ ç§å¸¸è§çš„æ‹¼æ¥æ–¹å¼</a></li>
    <li><a href="#æ€§èƒ½æ¯”è¾ƒ">æ€§èƒ½æ¯”è¾ƒ</a>
      <ul>
        <li><a href="#æ¯”è¾ƒé€»è¾‘ä»£ç ">æ¯”è¾ƒé€»è¾‘ä»£ç </a></li>
        <li><a href="#ç»“æœåˆ†æ">ç»“æœåˆ†æ</a></li>
      </ul>
    </li>
    <li><a href="#æ€§èƒ½åˆ†æ">æ€§èƒ½åˆ†æ</a>
      <ul>
        <li><a href="#stringsbuilder-çš„æ€§èƒ½ä¼šæ¯”--æé«˜é‚£ä¹ˆå¤šçš„åŸå› "><code>strings.Builder</code> çš„æ€§èƒ½ä¼šæ¯” <code>+</code> æé«˜é‚£ä¹ˆå¤šçš„åŸå› </a></li>
        <li><a href="#é¢„åˆ†é…-çš„æ€§èƒ½å¾—åˆ°å¤§å¹…æå‡çš„åŸå› "><code>é¢„åˆ†é…</code> çš„æ€§èƒ½å¾—åˆ°å¤§å¹…æå‡çš„åŸå› </a></li>
      </ul>
    </li>
  </ul>
</nav>
          </div>
      </details>
    </aside>
  


    


    <div class="content">
      <blockquote>
<p>åœ¨ Go è¯­è¨€ä¸­ï¼Œå­—ç¬¦ä¸²(string) æ˜¯ä¸å¯å˜çš„ï¼Œæ‹¼æ¥å­—ç¬¦ä¸²äº‹å®ä¸Šæ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²å¯¹è±¡ã€‚å¦‚æœä»£ç ä¸­å­˜åœ¨å¤§é‡çš„å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå¯¹æ€§èƒ½ä¼šäº§ç”Ÿä¸¥é‡çš„å½±å“ã€‚</p>
</blockquote>
<h2 id="å‡ ç§å¸¸è§çš„æ‹¼æ¥æ–¹å¼">å‡ ç§å¸¸è§çš„æ‹¼æ¥æ–¹å¼ <a href="#%e5%87%a0%e7%a7%8d%e5%b8%b8%e8%a7%81%e7%9a%84%e6%8b%bc%e6%8e%a5%e6%96%b9%e5%bc%8f" class="anchor">ğŸ”—</a></h2><ol>
<li>ä½¿ç”¨ <span style="color:#87CEEB; font-size:20px"><code>+</code></span> è¿›è¡Œæ‹¼æ¥ï¼›</li>
<li>ä½¿ç”¨ <span style="color:#87CEEB; font-size:20px"><code>fmt.Spintf()</code></span> è¿›è¡Œæ‹¼æ¥;</li>
<li>ä½¿ç”¨ <span style="color:#87CEEB; font-size:20px"><code>strings.Builderï¼ˆå¯é¢„åˆ†é…ï¼‰</code></span> è¿›è¡Œæ‹¼æ¥ï¼ˆæ¨èï¼‰;</li>
<li>ä½¿ç”¨ <span style="color:#87CEEB; font-size:20px"><code>bytes.Buffer</code></span> è¿›è¡Œæ‹¼æ¥;</li>
<li>ä½¿ç”¨ <span style="color:#87CEEB; font-size:20px"><code>[]byteï¼ˆå¯é¢„åˆ†é…ï¼‰</code></span> è¿›è¡Œæ‹¼æ¥ï¼›</li>
</ol>
<h2 id="æ€§èƒ½æ¯”è¾ƒ">æ€§èƒ½æ¯”è¾ƒ <a href="#%e6%80%a7%e8%83%bd%e6%af%94%e8%be%83" class="anchor">ğŸ”—</a></h2><h3 id="æ¯”è¾ƒé€»è¾‘ä»£ç ">æ¯”è¾ƒé€»è¾‘ä»£ç  <a href="#%e6%af%94%e8%be%83%e9%80%bb%e8%be%91%e4%bb%a3%e7%a0%81" class="anchor">ğŸ”—</a></h3><blockquote>
<p><code>go test -bench=&quot;Concat$&quot; -benchmem .</code>  // æ­£åˆ™æ‰§è¡Œä»¥ Concat ç»“å°¾çš„ benchmark å‡½æ•°ï¼Œ-benchmem è¡¨ç¤ºæ˜¾ç¤ºå†…å­˜åˆ†é…ä¿¡æ¯</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;bytes&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;math/rand&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;strings&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;testing&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">letterBytes</span> = <span style="color:#e6db74">&#34;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">randomString</span>(<span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>) <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">b</span> <span style="color:#f92672">:=</span> make([]<span style="color:#66d9ef">byte</span>, <span style="color:#a6e22e">n</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">b</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">b</span>[<span style="color:#a6e22e">i</span>] = <span style="color:#a6e22e">letterBytes</span>[<span style="color:#a6e22e">rand</span>.<span style="color:#a6e22e">Intn</span>(len(<span style="color:#a6e22e">letterBytes</span>))]
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> string(<span style="color:#a6e22e">b</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">plusConcat</span>(<span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">str</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">s</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">n</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">s</span> <span style="color:#f92672">+=</span> <span style="color:#a6e22e">str</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">s</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">sprintfConcat</span>(<span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">str</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">s</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">n</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">s</span> = <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">&#34;%s%s&#34;</span>, <span style="color:#a6e22e">s</span>, <span style="color:#a6e22e">str</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">s</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">builderConcat</span>(<span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">str</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">builder</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">Builder</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">n</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">builder</span>.<span style="color:#a6e22e">WriteString</span>(<span style="color:#a6e22e">str</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">builder</span>.<span style="color:#a6e22e">String</span>()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">preBuilderConcat</span>(<span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">str</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">builder</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">Builder</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">builder</span>.<span style="color:#a6e22e">Grow</span>(<span style="color:#a6e22e">n</span> <span style="color:#f92672">*</span> len(<span style="color:#a6e22e">str</span>))
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">n</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">builder</span>.<span style="color:#a6e22e">WriteString</span>(<span style="color:#a6e22e">str</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">builder</span>.<span style="color:#a6e22e">String</span>()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">bufferConcat</span>(<span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">s</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">buf</span> <span style="color:#f92672">:=</span> new(<span style="color:#a6e22e">bytes</span>.<span style="color:#a6e22e">Buffer</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">n</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">buf</span>.<span style="color:#a6e22e">WriteString</span>(<span style="color:#a6e22e">s</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">buf</span>.<span style="color:#a6e22e">String</span>()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">byteConcat</span>(<span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">str</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">buf</span> <span style="color:#f92672">:=</span> make([]<span style="color:#66d9ef">byte</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">n</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">buf</span> = append(<span style="color:#a6e22e">buf</span>, <span style="color:#a6e22e">str</span><span style="color:#f92672">...</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> string(<span style="color:#a6e22e">buf</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">[]byte çš„å‡çº§ç‰ˆï¼šé¢„åˆ†é…å®¹é‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">*/</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">preByteConcat</span>(<span style="color:#a6e22e">n</span> <span style="color:#66d9ef">int</span>, <span style="color:#a6e22e">str</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">buf</span> <span style="color:#f92672">:=</span> make([]<span style="color:#66d9ef">byte</span>, <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">n</span><span style="color:#f92672">*</span>len(<span style="color:#a6e22e">str</span>))
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">n</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">buf</span> = append(<span style="color:#a6e22e">buf</span>, <span style="color:#a6e22e">str</span><span style="color:#f92672">...</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> string(<span style="color:#a6e22e">buf</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">benchmark</span>(<span style="color:#a6e22e">b</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">B</span>, <span style="color:#a6e22e">f</span> <span style="color:#66d9ef">func</span>(<span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">str</span> = <span style="color:#a6e22e">randomString</span>(<span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">N</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">f</span>(<span style="color:#ae81ff">10000</span>, <span style="color:#a6e22e">str</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">BenchmarkPlusConcat</span>(<span style="color:#a6e22e">b</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">B</span>)       { <span style="color:#a6e22e">benchmark</span>(<span style="color:#a6e22e">b</span>, <span style="color:#a6e22e">plusConcat</span>) }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">BenchmarkSprintfConcat</span>(<span style="color:#a6e22e">b</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">B</span>)    { <span style="color:#a6e22e">benchmark</span>(<span style="color:#a6e22e">b</span>, <span style="color:#a6e22e">sprintfConcat</span>) }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">BenchmarkBuilderConcat</span>(<span style="color:#a6e22e">b</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">B</span>)    { <span style="color:#a6e22e">benchmark</span>(<span style="color:#a6e22e">b</span>, <span style="color:#a6e22e">builderConcat</span>) }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">BenchmarkPreBuilderConcat</span>(<span style="color:#a6e22e">b</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">B</span>) { <span style="color:#a6e22e">benchmark</span>(<span style="color:#a6e22e">b</span>, <span style="color:#a6e22e">preBuilderConcat</span>) }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">BenchmarkBufferConcat</span>(<span style="color:#a6e22e">b</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">B</span>)     { <span style="color:#a6e22e">benchmark</span>(<span style="color:#a6e22e">b</span>, <span style="color:#a6e22e">bufferConcat</span>) }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">BenchmarkByteConcat</span>(<span style="color:#a6e22e">b</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">B</span>)       { <span style="color:#a6e22e">benchmark</span>(<span style="color:#a6e22e">b</span>, <span style="color:#a6e22e">byteConcat</span>) }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">BenchmarkPreByteConcat</span>(<span style="color:#a6e22e">b</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">B</span>)    { <span style="color:#a6e22e">benchmark</span>(<span style="color:#a6e22e">b</span>, <span style="color:#a6e22e">preByteConcat</span>) }
</span></span></code></pre></div><h3 id="ç»“æœåˆ†æ">ç»“æœåˆ†æ <a href="#%e7%bb%93%e6%9e%9c%e5%88%86%e6%9e%90" class="anchor">ğŸ”—</a></h3><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>BenchmarkPlusConcat-16                        <span style="color:#ae81ff">22</span>          <span style="color:#ae81ff">55582405</span> ns/op        <span style="color:#ae81ff">530998167</span> B/op     <span style="color:#ae81ff">10026</span> allocs/op
</span></span><span style="display:flex;"><span>BenchmarkSprintfConcat-16                     <span style="color:#ae81ff">12</span>          <span style="color:#ae81ff">95173333</span> ns/op        <span style="color:#ae81ff">833644274</span> B/op     <span style="color:#ae81ff">34183</span> allocs/op
</span></span><span style="display:flex;"><span>BenchmarkBuilderConcat-16                  <span style="color:#ae81ff">12667</span>            <span style="color:#ae81ff">107742</span> ns/op          <span style="color:#ae81ff">514801</span> B/op         <span style="color:#ae81ff">23</span> allocs/op
</span></span><span style="display:flex;"><span>BenchmarkPreBuilderConcat-16               <span style="color:#ae81ff">29996</span>             <span style="color:#ae81ff">40795</span> ns/op          <span style="color:#ae81ff">106496</span> B/op          <span style="color:#ae81ff">1</span> allocs/op
</span></span><span style="display:flex;"><span>BenchmarkBufferConcat-16                   <span style="color:#ae81ff">14992</span>             <span style="color:#ae81ff">81504</span> ns/op          <span style="color:#ae81ff">368577</span> B/op         <span style="color:#ae81ff">13</span> allocs/op
</span></span><span style="display:flex;"><span>BenchmarkByteConcat-16                      <span style="color:#ae81ff">9874</span>            <span style="color:#ae81ff">112861</span> ns/op          <span style="color:#ae81ff">621297</span> B/op         <span style="color:#ae81ff">24</span> allocs/op
</span></span><span style="display:flex;"><span>BenchmarkPreByteConcat-16                  <span style="color:#ae81ff">24306</span>             <span style="color:#ae81ff">50880</span> ns/op          <span style="color:#ae81ff">212992</span> B/op          <span style="color:#ae81ff">2</span> allocs/op
</span></span></code></pre></div><ul>
<li>å››åˆ—ç»“æœåˆ†åˆ«è¡¨ç¤ºï¼š1så†…è¯¥æ–¹æ³•ä¸€å…±æ‰§è¡Œäº†å¤šå°‘æ¬¡ï¼ˆè¶Šå¤§è¶Šå¥½ï¼‰ã€ns/op ä¸ºæ¯æ¬¡æ‰§è¡Œè¯¥æ–¹æ³•éœ€è¦çš„æ—¶é—´ï¼ˆè¶Šå°è¶Šå¥½ï¼‰ã€B/op ä¸ºæ¯æ¬¡æ‰§è¡Œå‡½æ•°åˆ†é…å¤šå°‘å†…å­˜ï¼ˆè¶Šå°è¶Šå¥½ï¼‰ã€allocs/op ä¸ºæ¯æ¬¡æ‰§è¡Œå‡½æ•°ä¸€å…±åˆ†é…äº†å¤šå°‘æ¬¡å†…å­˜ï¼ˆè¶Šå°è¶Šå¥½ï¼‰ï¼›</li>
<li>ä½¿ç”¨ fmt.Sprintf æœ€å·®ï¼Œåˆ†é…çš„å†…å­˜æ¬¡æ•°å’Œå¤§å°æœ€å¤§ï¼›+ æ€§èƒ½ä¹Ÿå¾ˆå·®ï¼›</li>
<li>strings.Builderï¼ˆé¢„åˆ†é…ï¼‰&gt; []byteï¼ˆé¢„åˆ†é…ï¼‰&gt; bytes.Buffer &gt; strings.Builder &gt; []byte &gt; +å· &gt; fmt.Spirntf</li>
</ul>
<h2 id="æ€§èƒ½åˆ†æ">æ€§èƒ½åˆ†æ <a href="#%e6%80%a7%e8%83%bd%e5%88%86%e6%9e%90" class="anchor">ğŸ”—</a></h2><blockquote>
<p>æˆ‘ä»¬å‘ç°ä¸Šé¢ <code>å†…å­˜åˆ†é…æ¬¡æ•°è¶Šå°‘</code>ï¼Œæ€§èƒ½è¶Šé«˜ï¼›<code>å†…å­˜åˆ†é…å¤§å°è¶Šå°</code>ï¼Œæ€§èƒ½è¶Šé«˜ï¼›</p>
</blockquote>
<h3 id="stringsbuilder-çš„æ€§èƒ½ä¼šæ¯”--æé«˜é‚£ä¹ˆå¤šçš„åŸå› "><code>strings.Builder</code> çš„æ€§èƒ½ä¼šæ¯” <code>+</code> æé«˜é‚£ä¹ˆå¤šçš„åŸå›  <a href="#stringsbuilder-%e7%9a%84%e6%80%a7%e8%83%bd%e4%bc%9a%e6%af%94--%e6%8f%90%e9%ab%98%e9%82%a3%e4%b9%88%e5%a4%9a%e7%9a%84%e5%8e%9f%e5%9b%a0" class="anchor">ğŸ”—</a></h3><p>Â Â Â Â Â Â Â Â å› ä¸ºå­—ç¬¦ä¸²çš„ä¿®æ”¹åŸç†æ˜¯ï¼šå› ä¸ºå­—ç¬¦ä¸²å¯ä»¥çœ‹åšæ˜¯åˆ†é…åœ¨ <code>åªè¯»å†…å­˜ç©ºé—´</code>ä¸Šçš„ []byteï¼Œæ¯æ¬¡ä¿®æ”¹éœ€è¦å…ˆåœ¨ <code>å¯å†™å†…å­˜ç©ºé—´</code> ä¸Šé¢åˆ†é…å†…å­˜å˜é‡ []byteï¼ŒæŠŠ <code>åªè¯»å†…å­˜ç©ºé—´</code> ä¸Šé¢çš„ []byte è½¬ç§»åˆ° <code>å¯å†™å†…å­˜ç©ºé—´</code> []byte ä¸Šï¼Œç„¶åä¿®æ”¹ï¼Œä¿®æ”¹å®Œæˆä¹‹åéœ€è¦å†å†™å…¥åˆ° <code>åªè¯»å†…å­˜ç©ºé—´</code> ï¼ˆè¿™ä¸ª <code>æ–°åªè¯»ç©ºé—´</code> å’Œä¹‹å‰é‚£ä¸ª <code>æ—§åªè¯»ç©ºé—´</code> å®Œå…¨æ²¡æœ‰å…³ç³»ï¼‰ã€‚<br />
Â Â Â Â Â Â Â Â æ‰€ä»¥æ¯æ¬¡ + æ‹¼æ¥å­—ç¬¦ä¸²å…¶å®å°±æ˜¯ä¸€æ¬¡ä¿®æ”¹å­—ç¬¦ä¸²ï¼Œéƒ½éœ€è¦é‡å¤ä¸Šé¢çš„åˆ†é…å†…å­˜æ“ä½œï¼›è€Œä¸”å› ä¸ºå‰åä¸¤æ¬¡çš„ <code>åªè¯»å†…å­˜ç©ºé—´</code> å®Œå…¨ä¸ä¸€è‡´ï¼Œæ‰€ä»¥éœ€è¦æ›´å¤šçš„å†…å­˜åˆ†é…ã€‚<br />
Â Â Â Â Â Â Â Â å¯æ˜¯ <code>strings.Builder</code> å…¶å®åº•å±‚æ˜¯ä¸€ä¸ª <code>[]byte</code> å’Œä¸€ä¸ª <code>æŒ‡å‘ []byteé¦–ä½ç©ºé—´çš„æŒ‡é’ˆåœ°å€</code> ç»„æˆï¼›æ‰€ä»¥å¹¶ä¸æ˜¯æ¯æ¬¡æ‹¼æ¥éƒ½éœ€è¦é‡æ–°åˆ†é…å†…å­˜ï¼Œåªæœ‰åœ¨ []byte ç°éœ€è¦æ‰©å®¹çš„æ—¶å€™æ‰ä¼šé‡æ–°åˆ†é…å†…å­˜ï¼›æ‰€ä»¥å®ƒçš„åˆ†é…æ¬¡æ•°ä¼šå¤§å¤§é™ä½ï¼›<br />
Â Â Â Â Â Â Â Â ä¾‹å¦‚ï¼šç°åœ¨æœ‰ä¸€ä¸ªå­—ç¬¦ä¸² &ldquo;a&rdquo;ï¼Œå¾ªç¯æ‹¼æ¥ 1024 æ¬¡ï¼›<br />
Â Â Â Â Â Â Â Â ä½¿ç”¨ <code>+</code> æ‹¼æ¥ï¼šå› ä¸ºæ¯æ¬¡éƒ½éœ€è¦åˆ†é…å†…å­˜ï¼Œæ‰€ä»¥ä¸€å…±éœ€è¦åˆ†é… 1024 æ¬¡å†…å­˜ï¼Œæ€»å…±éœ€è¦çš„å†…å­˜ç©ºé—´æ˜¯ 1 + 1 * 2 + 1 * 3 + 1 * 4 + &hellip; + 1 * 1024 byte = 5MB<br />
Â Â Â Â Â Â Â Â ä½¿ç”¨ <code>strings.Builder</code> æ‹¼æ¥ï¼šå› ä¸ºåªæœ‰è§¦å‘ slice æ‰©å®¹çš„æ—¶å€™æ‰éœ€è¦åˆ†é…å†…å­˜ï¼Œè§¦å‘æ‰©å®¹çš„æ—¶æœºæ˜¯ï¼šç¬¬ 1 æ¬¡ã€ ç¬¬ 2 æ¬¡ã€ç¬¬ 4 æ¬¡ï¼Œç¬¬ 8 æ¬¡ &hellip; ç¬¬ 29 æ¬¡ï¼Œä¸€å…±éœ€è¦åˆ†é… 10 æ¬¡å³å¯ï¼Œæ€»å…±éœ€è¦åˆ†é…çš„å†…å­˜å¤§å°ï¼š1 + 2 + 4 + &hellip; + 1024 byte = 5KB</p>
<h3 id="é¢„åˆ†é…-çš„æ€§èƒ½å¾—åˆ°å¤§å¹…æå‡çš„åŸå› "><code>é¢„åˆ†é…</code> çš„æ€§èƒ½å¾—åˆ°å¤§å¹…æå‡çš„åŸå›  <a href="#%e9%a2%84%e5%88%86%e9%85%8d-%e7%9a%84%e6%80%a7%e8%83%bd%e5%be%97%e5%88%b0%e5%a4%a7%e5%b9%85%e6%8f%90%e5%8d%87%e7%9a%84%e5%8e%9f%e5%9b%a0" class="anchor">ğŸ”—</a></h3><p>Â Â Â Â Â Â Â Â å› ä¸ºé‡‡ç”¨ <code>é¢„åˆ†é…</code> å‡ ä¹å®Œå…¨é¿å…äº†å†…å­˜çš„åˆ†é…ï¼Œæˆ‘ä»¬çŸ¥é“å†…å­˜çš„é¢‘ç¹åˆ†é…æ˜¯é€ æˆæ€§èƒ½ä½ä¸‹çš„ä¸»è¦åŸå› ï¼Œé¢„åˆ†é…åªç”¨åœ¨åˆæ¬¡åˆ†é…ä¸€æ¬¡å³å¯ï¼Œæ‰€ä»¥ç›¸æ¯”è¾ƒ <code>+</code> æ‹¼æ¥æ¯æ¬¡éƒ½éœ€è¦åˆ†é…ä¸€æ¬¡å†…å­˜ï¼Œä»¥åŠç›¸æ¯”è¾ƒ <code>strings.Builder</code> å’Œ <code>bytes.Buffer</code> å€ŸåŠ© slice çš„æ‰©å®¹ç­–ç•¥è¿›è¡Œåˆ†é…å†…å­˜ï¼Œæœ‰äº†è´¨çš„æå‡ã€‚æ‰€ä»¥æ€§èƒ½å¾—åˆ°äº†å¤§å¹…åº¦çš„æå‡ã€‚</p>

    </div>

    
        <div class="tags">
            
                <a href="/tags/go">GO</a>
            
                <a href="/tags/go-%E9%AB%98%E6%80%A7%E8%83%BD">GO é«˜æ€§èƒ½</a>
            
                <a href="/tags/go-%E6%8A%80%E5%B7%A7">GO æŠ€å·§</a>
            
        </div>
    
    
    

</section>


    </main>
    
    <footer id="footer">
    

    <div class="copyright">
    
        
    
    </div>

    
</footer>



  </body>
</html>
